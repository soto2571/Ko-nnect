{% extends "base.html" %}

{% block title %}Admin-Panel{% endblock %}

{% block content %}
        
<div class="content p-4">
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
        <!-- Set Business Hours Card -->
        <div class="bg-white backdrop-blur-lg p-6 shadow-md rounded-lg opacity-90">
            <form method="POST" action="{{ url_for('admin.set_business_hours') }}">
                <h3 class="text-xl font-bold mb-4 text-center">Set Business Hours and Days</h3>

                <!-- Opening Time -->
                <div class="form-group mb-4">
                    <label for="opening_time" class="block text-sm font-medium text-gray-700">Opening Time</label>
                    <input type="time" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="opening_time" name="opening_time" required>
                </div>

                <!-- Closing Time -->
                <div class="form-group mb-4">
                    <label for="closing_time" class="block text-sm font-medium text-gray-700">Closing Time</label>
                    <input type="time" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="closing_time" name="closing_time" required>
                </div>

                <!-- Business Days -->
                <div class="form-group mb-4">
                    <label class="block text-sm font-medium text-gray-700">Business Days:</label>
                    {% for day, name in [(0, 'Monday'), (1, 'Tuesday'), (2, 'Wednesday'), (3, 'Thursday'), (4, 'Friday'), (5, 'Saturday'), (6, 'Sunday')] %}
                        <label><input type="checkbox" name="business_days" value="{{ day }}"> {{ name }}</label><br>
                    {% endfor %}
                </div>

                <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full">Submit</button>
            </form>
        </div>

        <!-- Create Schedule Card -->
        <div class="bg-white backdrop-blur-lg p-6 shadow-md rounded-lg opacity-90 h-auto">
            <form method="POST" action="{{ url_for('admin.create_schedule') }}">
                <h3 class="text-xl font-bold mb-4 text-center">Create Schedule</h3>

                <div class="form-group mb-4">
                    <label for="shift_start" class="block text-sm font-medium text-gray-700">Entry Hour</label>
                    <input type="datetime-local" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="shift_start" name="shift_start" required>
                </div>

                <div class="form-group mb-4">
                    <label for="shift_end" class="block text-sm font-medium text-gray-700">Exit Hour</label>
                    <input type="datetime-local" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="shift_end" name="shift_end" required>
                </div>

                <div class="form-group mb-4">
                    <label for="employee_id" class="block text-sm font-medium text-gray-700">Employee</label>
                    <select class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="employee_id" name="employee_id" required>
                        {% for employee in employees %}
                            <option value="{{ employee.id }}">{{ employee.first_name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full">Submit</button>
            </form>
        </div>

        <!-- Create New User Card -->
        <div class="bg-white p-6 shadow-md opacity-90 rounded-lg">
            <form method="POST" action="{{ url_for('admin.create_user') }}">
                <h3 class="text-xl font-bold mb-4 text-center">Create New User</h3>

                <div class="form-group mb-4">
                    <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                    <input type="email" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="email" name="email" required>
                </div>

                <div class="form-group mb-4">
                    <label for="first_name" class="block text-sm font-medium text-gray-700">First Name</label>
                    <input type="text" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="first_name" name="first_name" required>
                </div>

                <div class="form-group mb-4">
                    <label for="password" class="block text-sm font-medium text-gray-700">Password</label>
                    <input type="password" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="password" name="password" required>
                </div>

                <div class="form-group mb-4">
                    <label for="password_confirm" class="block text-sm font-medium text-gray-700">Confirm Password</label>
                    <input type="password" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="password_confirm" name="password_confirm" required>
                </div>

                <div class="form-group mb-4">
                    <label for="availability" class="block text-sm font-medium text-gray-700">Availability</label>
                    <input type="text" class="mt-1 block w-full p-2 border-gray-300 rounded-md" id="availability" name="availability">
                </div>

                <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full">Submit</button>
            </form>
        </div>
    </div>

    <!-- Employee List & Schedules Section -->
    <div class="mt-8 colorText">
        <h3 class="text-2xl font-bold text-center">Employee List & Schedules</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
            {% for employee in employees %}
                <div class="bg-white p-4 shadow-md rounded-lg hover:shadow-lg transition-shadow duration-300">
                    <h4 class="font-semibold text-xl">{{ employee.first_name }}</h4>
                    <p><strong>Email:</strong> {{ employee.email }}</p>
                    <p><strong>Availability:</strong> {{ employee.availability }}</p>

                    <div class="schedule-boxes mt-3">
                        {% for schedule in schedules if schedule.employee_id == employee.id %}
                            <div class="schedule-box border p-2 rounded-md mb-2 {% if schedule not in valid_schedules %} bg-red-100 {% endif %}">
                                <p><strong>Start:</strong> {{ schedule.shift_start.strftime('%Y-%m-%d %H:%M') }}</p>
                                <p><strong>End:</strong> {{ schedule.shift_end.strftime('%Y-%m-%d %H:%M') }}</p>
                                
                                <!-- Responsive Buttons for Edit and Delete -->
                                <div class="flex gap-2 mt-2">
                                    <button class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-4 rounded text-sm">
                                        Edit
                                    </button>

                                    <form method="POST" action="{{ url_for('admin.delete_schedule', id=schedule.id) }}">
                                        <button type="submit" class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded text-sm">
                                            Delete Schedule
                                        </button>
                                    </form>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Add Tailwind-based Custom CSS for Mobile Optimization -->
<style>
    .content {
        padding: 1rem;
    }
    
    .colorText {
        color: white;
    }

    .schedule-box {
        background-color: #f9f9f9;
    }
</style>
{% endblock %}
